# Gemini CLI プロジェクトコンテキスト (日本語版)

## 1. プロジェクト概要

これは、Next.jsで構築された、瞑想とリラクゼーションのコンテンツに特化した、モダンな多言語対応ウェブアプリケーションです。ユーザーに対して音声や動画コンテンツを提供し、堅牢な認証システムを備えています。

- **目的**: 瞑想とリラクゼーションのコンテンツ配信プラットフォーム
- **主な機能**:
    - ユーザー認証（ログイン・ログアウト）
    - 多言語対応（日本語、英語、スペイン語）
    - 音声および動画コンテンツの再生
    - リソース取得のためのAPIエンドポイント

## 2. コア技術

- **フレームワーク**: **Next.js 14+** (**App Router** を使用)
- **言語**: **TypeScript**
- **スタイリング**: **Tailwind CSS** によるユーティリティファーストのスタイリング
    - 設定ファイル: `tailwind.config.ts`, `postcss.config.mjs`
- **UIコンポーネント**: **Shadcn/UI** (`components.json`, `src/components/ui/`)。カスタムの再利用可能なコンポーネントは `src/components/` に配置。
- **認証**: **NextAuth.js (v5 / Auth.js)**
    - 設定は `src/lib/auth.ts` と `src/lib/nextAuth.ts` に記述。
    - APIエンドポイントは `src/app/api/auth/[...nextauth]/route.ts`。
- **国際化 (i18n)**: **`i18next`** および **`react-i18next`**
    - 設定ファイル: `src/i18n/server.ts` (サーバーサイド), `src/i18n/client.tsx` (クライアントサイド), `src/i18n/settings.ts` (共通設定)
- **リンティング**: ESLint (`.eslintrc.json`) を使用してコードスタイルを強制。

## 3. プロジェクト構造

プロジェクトは `src` ディレクトリ内で、機能指向の構造に従っています。

- `src/app/[lang]/`: アプリケーションのコアであり、ユーザー向けのすべてのページが含まれる。
    - `[lang]` 動的セグメントが言語（`ja`, `en`, `es`）を処理。
    - `layout.tsx`: 特定言語のアプリケーション全体のルートレイアウト。
    - `page.tsx`: メインのランディング/ホームページ。
    - `meditation/`: 瞑想機能に関連するページ。
    - `login/`: ユーザーログインページ。

- `src/app/api/`: すべてのバックエンドAPIルートが含まれる。
    - `auth/`: NextAuth.jsによる認証エンドポイントを処理。
    - `sounds/`, `users/`: アプリケーションデータ用のカスタムAPIルート。

- `src/components/`: 再利用可能なReactコンポーネントが含まれる。
    - `ui/`: Shadcn/UIコンポーネント専用。
    - その他 (`Header.tsx`, `Audio.tsx`など) は、このアプリケーション用のカスタムコンポーネント。

- `src/lib/`: コアなビジネスロジック、外部サービス連携、ヘルパー関数を格納。
    - `auth.ts`: NextAuth.jsのコア設定。
    - `firebase.ts`: Firebase連携（使用している場合）。
    - `utils.ts`: 一般的なユーティリティ関数。

- `src/i18n/`: 国際化設定を管理。
    - `locales/`: 翻訳ファイル（TS/JSON）を格納。言語ごと、さらに機能/ページごとに整理。
        - 例: `src/i18n/locales/ja/meditation.ts` は瞑想ページの日本語翻訳を保持。

- `src/middleware.ts`: Next.jsミドルウェアを実装。リクエストの認証やi18nの言語ルーティングを処理している可能性が高い。

- `public/`: 公開アクセス可能なすべての静的アセットを格納。
    - `images/`, `sounds/`, `videos/`: アプリケーション全体で使用されるメディアファイル。

## 4. 主要なコンセプトとコーディング規約

- **ルーティング**: すべてのページはApp Routerの一部。URLは言語コードで始まる (例: `/ja/login`)。
- **データ取得**: Next.jsのパフォーマンス上の利点を活かすため、可能な限りサーバーコンポーネントでデータ取得を行う。クライアントサイドでの取得は `src/app/api` のカスタムAPIルート経由で行う。
- **スタイリング**:
    - **Tailwind CSSのユーティリティクラス**をJSX内に直接記述する。
    - 複雑なコンポーネントのために専用のCSSファイルを作成することも可能だが、ユーティリティファーストを優先する。
    - `tailwind.config.ts` で定義されたデザインシステムに従う。
- **状態管理**: クライアントサイドの状態には、React Hooks (`useState`, `useContext`, `useReducer`) を優先的に使用する。グローバルな状態については、`src/app/components/Providers.tsx` がReact Contextベースのアプローチを示唆している。
- **国際化 (i18n)**:
    - ユーザー向けのテキストは**日本語、英語、スペイン語**翻訳する必要がある。
    - 新しい翻訳キーは `src/i18n/locales/{lang}/{namespace}.ts` の適切なファイルに追加する。
    - サーバーサイドでは `src/i18n/server.ts` の `createTranslation` 関数を使用する。
    - クライアントサイドでは `src/i18n/client.tsx` の `useTranslation` フックを使用する。
- **TypeScript**:
    - すべての新しいコードはTypeScriptで記述する。
    - 厳密な型付けを行い、可能な限り `any` の使用を避ける。
    - APIレスポンスやコンポーネントのpropsに型を定義する。
- **コンポーネント**:
    - 小さく、再利用可能なコンポーネントを作成する。
    - すべてのコンポーネントは、フックを持つ関数コンポーネントとする。
